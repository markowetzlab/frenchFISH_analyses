Reproducing the FrenchFISH manuscript analyses
=====
This repository contains the code required to reproduce the results and figures of the `FrenchFISH` [manuscript](https://doi.org/10.1101/487926).
`FrenchFISH` is a method and corresponding R package for for correcting spot counts used for quantifying DNA copy-number from fluorescence in situ hybridisation of tissue sections. It can correct either spot counts from manual counting, or from an automatic spot counting software. The underlying models used to correct these counts are Poissonian.

Installing the frenchFISH R package
----
```r
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("frenchFISH")
```

Running analyses and generating figures
----
After installing the frenchFISH package, the analyses and figures of the paper can be generated by running `frenchFISH_analyses.Rmd`. Before running, it is necessary that `path_to_dir` in the markdown file be set to the path to `frenchFISH_analyses`.
In addition to simulating FISH spot count data for correction, this markdown file will access the `automatic_counts` and `manual_counts` directories, where CSV files containing the uncorrected spot counts for 12 ovarian cancer FFPE-tissue sections are stored.

Downloading the FISH images used in the paper
----
12 ovarian cancer FFPE-tissue sections assessed in the paper can be downloaded from the [Cell Image Library]( http://cellimagelibrary.org/images?k=Cancer+Research+UK+Cambridge+Institute+&simple_search=Search&per_page=10&page=1). These images comprise z-stacks of TIFF images, where each z-stack is one of the tiles of the tissue section images used for analysis.

Regenerating spot count CSV files
----
Once the 12 image directories have been downloaded, they should be added to a directory called `image_processing/input_data`. All images from each tissue section should be included in a subdirectory named as that tissue section is named. `image_processing/input_data` should therefore include 12 subdirectories containing all TIFF images:

* `image_processing/input_data/BL_024216_Myc_Terc`
* `image_processing/input_data/BL024199_Myc_Terc`
* `image_processing/input_data/BL32077_Myc_Terc`
* `image_processing/input_data/BL32080_Myc_Terc`
* `image_processing/input_data/PS09_20676_2B_Myc_Terc`
* `image_processing/input_data/PS09_287383C_Myc_Terc`
* `image_processing/input_data/PS11_10021_2B_Myc_Terc`
* `image_processing/input_data/PS11_167511L_Myc_Terc`
* `image_processing/input_data/SC_007`
* `image_processing/input_data/SC_011`
* `image_processing/input_data/SC_028`
* `image_processing/input_data/SC_030`

 `image_processing` contains the necessary scripts to reproduce the uncorrected spot count CSVs used above. Before proceeding, create an empty directory `image_processing/results` for storing image processing results.
First, run `image_processing/run_focus_selector.sh`, which calls `image_processing/select_focus_project_x.ijm` on each of the 12 directories to generate JPEG max projections of the 10 layers around the most focused layer in each TIFF z-stack.
Finally, run `image_processing/image_processing.R` to automatically count the spots in these max projection images using the `FishalyzeR` package.

Disclaimer
----
Note that this is prerelease software. Please use accordingly.
